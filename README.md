
# í´ë”êµ¬ì¡° ì„¤ì • 

    project/
    â”‚
    â”œâ”€â”€ data/
    â”‚   â”œâ”€â”€ raw/
    â”‚   â”‚   â”œâ”€â”€ train_images/
    â”‚   â”‚   â””â”€â”€ train_annotations/
    â”‚   â””â”€â”€ processed/
    â”‚       â”œâ”€â”€ matched_pairs.csv
    â”‚       â””â”€â”€ train_labels.csv
    â”‚
    â”œâ”€â”€ src/
    â”‚   â”œâ”€â”€ config/
    â”‚   â”‚   â”œâ”€â”€ data_config.py
    â”‚   â”‚   â”œâ”€â”€ train_config.py
    â”‚   â”‚   â””â”€â”€ inference_config.py
    â”‚   â”‚
    â”‚   â”œâ”€â”€ data/
    â”‚   â”‚   â”œâ”€â”€ data_pipeline.py        â† ê³µí†µ ingestion íŒŒì´í”„ë¼ì¸
    â”‚   â”‚   â””â”€â”€ pill_dataset.py         â† ê³µí†µ Dataset
    â”‚   â”‚
    â”‚   â”œâ”€â”€ models/
    â”‚   â”‚   â”œâ”€â”€ build_model.py
    â”‚   â”‚   â””â”€â”€ train_classifier.py
    â”‚   â”‚
    â”‚   â”œâ”€â”€ inference/
    â”‚   â”‚   â”œâ”€â”€ predictor.py            â† Streamlitë„ ì´ íŒŒì¼ë§Œ ì‚¬ìš©
    â”‚   â”‚   â””â”€â”€ utils.py
    â”‚   â”‚
    â”‚   â””â”€â”€ app/
    â”‚       â””â”€â”€ streamlit_app.py        â† MVP ì„œë¹„ìŠ¤ UI
    â”‚
    â””â”€â”€ requirements.txt
# ðŸ’Š AI ê¸°ë°˜ ê²½êµ¬ì•½ì œ ê°ì²´ íƒì§€ ë° ì•ˆì „ ì •ë³´ ì„œë¹„ìŠ¤ (Pill Detection Project)

## 1. í”„ë¡œì íŠ¸ ê°œìš” (Overview)
ë³¸ í”„ë¡œì íŠ¸ëŠ” ìŠ¤ë§ˆíŠ¸í°ìœ¼ë¡œ ì•Œì•½ì„ ì´¬ì˜í–ˆì„ ë•Œ, **ì•Œì•½ì˜ ì¢…ë¥˜ë¥¼ íƒì§€(Detection)**í•˜ê³  ë³‘ìš© ê¸ˆê¸° ë° ì—°ë ¹ë³„ ì£¼ì˜ì‚¬í•­ì„ ì œê³µí•˜ëŠ” í—¬ìŠ¤ì¼€ì–´ AI ì„œë¹„ìŠ¤ ê°œë°œì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤.

ë‹¨ìˆœí•œ ì‹¤í—˜ì‹¤ í™˜ê²½ì´ ì•„ë‹Œ, **ì‹¤ì œ ë³µìš© í™˜ê²½(ì•½ ë´‰ì§€, íˆ¬ëª… ë¹„ë‹ í¬ìž¥ ë“±)**ì—ì„œë„ ê°•ê±´í•˜ê²Œ ìž‘ë™í•˜ëŠ” ëª¨ë¸ì„ ë§Œë“¤ê¸° ìœ„í•´ **í˜„ì‹¤ì ì¸ ë°ì´í„° ì¦ê°•(Augmentation) íŒŒì´í”„ë¼ì¸**ì„ êµ¬ì¶•í•˜ëŠ” ë° ì§‘ì¤‘í–ˆìŠµë‹ˆë‹¤.

### ðŸŽ¯ í•µì‹¬ ëª©í‘œ
* **Robust Preprocessing:** ì•½ ë´‰ì§€(Pill Pouch) ë‚´ì˜ **ë¹› ë°˜ì‚¬, 360ë„ íšŒì „, ê²¹ì¹¨ í˜„ìƒ**ì„ ì‹œë®¬ë ˆì´ì…˜í•˜ì—¬ í•™ìŠµ ë°ì´í„°ì…‹ êµ¬ì¶•.
* **Service-Oriented EDA:** 5,000ì—¬ ì¢…ì˜ ë°ì´í„° ì¤‘, ì‹¤ì œ ì„œë¹„ìŠ¤ ê°€ëŠ¥í•œ **'ê°€ì •ìƒë¹„ì•½ Top 30'**ì„ ì„ ì •í•˜ì—¬ ë¹„ì¦ˆë‹ˆìŠ¤ ê°€ì¹˜ ì°½ì¶œ.
* **End-to-End Pipeline:** ì›ë³¸ ë°ì´í„°(AI Hub/Kaggle)ì˜ íŒŒíŽ¸í™”ëœ êµ¬ì¡°ë¥¼ ì •ì œ(Cleaning)í•˜ê³  í•™ìŠµ ê°€ëŠ¥í•œ í˜•íƒœë¡œ ë³€í™˜í•˜ëŠ” ìžë™í™” íŒŒì´í”„ë¼ì¸ êµ¬ì¶•.

---

## 2. ë°ì´í„° ì²˜ë¦¬ ì „ëžµ (Data Strategy)

### 2.1 ë°ì´í„° ë¬¸ì œì  ë° í•´ê²° (Merging & Cleaning)
* **ë¬¸ì œì :** ì œê³µëœ ì›ë³¸ ë°ì´í„°(Kaggle)ëŠ” ì•½ 1,000ê°œì˜ ë¶„ì‚°ëœ JSON íŒŒì¼ë¡œ ìª¼ê°œì ¸ ìžˆì—ˆìœ¼ë©°, JSONì—ëŠ” ì¡´ìž¬í•˜ì§€ë§Œ ì‹¤ì œ ì´ë¯¸ì§€ í´ë”ì—ëŠ” ì—†ëŠ” **'ìœ ë ¹ ë°ì´í„°(Ghost Data)'**ê°€ ë‹¤ìˆ˜ í¬í•¨ë˜ì–´ ìžˆì—ˆìŠµë‹ˆë‹¤.
* **í•´ê²°ì±…:**
    1. **Merging:** ë¶„ì‚°ëœ ëª¨ë“  JSONì„ ìž¬ê·€ íƒìƒ‰í•˜ì—¬ í•˜ë‚˜ì˜ `train.json` (COCO Format)ìœ¼ë¡œ ë³‘í•©.
    2. **Sanity Check & Cleaning:** ì‹¤ì œ ì´ë¯¸ì§€ ê²½ë¡œì™€ ì–´ë…¸í…Œì´ì…˜ì„ ëŒ€ì¡°í•˜ì—¬, ë§¤ì¹­ë˜ì§€ ì•ŠëŠ” ê²°ì¸¡ì¹˜ë¥¼ ì œê±°í•˜ê³  `train_final.json` ìƒì„±. (ë¬´ê²°ì„± í™•ë³´)

### 2.2 íƒìƒ‰ì  ë°ì´í„° ë¶„ì„ (EDA) & ì„œë¹„ìŠ¤ íƒ€ê²Ÿ ì„ ì •
* **ë°ì´í„° ë¶ˆê· í˜• í™•ì¸:** ë¶„ì„ ê²°ê³¼, íŠ¹ì • ì•Œì•½(ì˜ˆ: ì¼ì–‘í•˜ì´íŠ¸ë¦°ì •)ì— ë°ì´í„°ê°€ íŽ¸ì¤‘ëœ 'Lìží˜• ë¶„í¬'ë¥¼ í™•ì¸í–ˆìŠµë‹ˆë‹¤.
* **Top 30 ì„ ì •:** ì „ì²´ 56ì¢… ì¤‘ ë°ì´í„°ê°€ ê°€ìž¥ í’ë¶€í•˜ê³  ëŒ€ì¤‘ì ì¸ **ìƒìœ„ 30ê°œ í’ˆëª©**ì„ ì„ ì •í•˜ì—¬, íŒ€ì›ë“¤ê³¼ í•¨ê»˜ `[ì—°ë ¹ ê¸ˆê¸°/ì˜ì–‘ì œ ìƒí˜¸ìž‘ìš©]` ì •ë³´ë¥¼ ë§¤í•‘í•˜ëŠ” DB(`top30_pills_service.csv`)ë¥¼ êµ¬ì¶•í–ˆìŠµë‹ˆë‹¤.

---

## 3. ë°ì´í„° ì „ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸ (Preprocessing Pipeline)

ë³¸ í”„ë¡œì íŠ¸ì˜ ê°€ìž¥ í° ì°¨ë³„ì ì€ **'ì•½ ë´‰ì§€(Vinyl Pouch) í™˜ê²½'**ì„ ê°€ì •í•œ ê³ ë„í™”ëœ ì „ì²˜ë¦¬ ì „ëžµìž…ë‹ˆë‹¤.

### ðŸ› ï¸ ì‚¬ìš© ë¼ì´ë¸ŒëŸ¬ë¦¬: `Albumentations`
ê¸°ì¡´ `torchvision`ì€ ì´ë¯¸ì§€ íšŒì „ ì‹œ Bounding Box(ì •ë‹µ ì¢Œí‘œ)ê°€ ê¼¬ì´ëŠ” ë¬¸ì œê°€ ìžˆì–´, **ì´ë¯¸ì§€ì™€ ë°•ìŠ¤ ì¢Œí‘œë¥¼ ë™ì‹œì— ë³€í™˜**í•  ìˆ˜ ìžˆëŠ” `Albumentations`ë¥¼ ë„ìž…í–ˆìŠµë‹ˆë‹¤.

### ðŸ§ª ì¦ê°•(Augmentation) ìƒì„¸ ì „ëžµ
ì‹¤ì œ ì•½ ë´‰ì§€ ì•ˆì˜ ì•Œì•½ì€ ì •ì§í•˜ê²Œ ë†“ì—¬ìžˆì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ë¥¼ ëª¨ì‚¬í•˜ê¸° ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì€ ê¸°ë²•ì„ ì ìš©í–ˆìŠµë‹ˆë‹¤.

| ê¸°ë²• (Technique) | ì ìš© ì´ìœ  (Why?) | í™•ë¥  (p) |
| :--- | :--- | :--- |
| **Random Rotate (180Â°)** | ì•½ ë´‰ì§€ ì•ˆì—ì„œ ì•Œì•½ì€ 360ë„ ìžìœ ë¡­ê²Œ íšŒì „í•¨. | 0.7 |
| **Vertical/Horizontal Flip** | ì•Œì•½ì€ ìƒí•˜ì¢Œìš° ëŒ€ì¹­ì¸ ê²½ìš°ê°€ ë§Žì•„ ì•žë’¤/ìœ„ì•„ëž˜ êµ¬ë¶„ì´ ëª¨í˜¸í•¨. | 0.5 |
| **Gaussian Blur** | íˆ¬ëª… ë¹„ë‹ ë„ˆë¨¸ë¡œ ì´¬ì˜ ì‹œ í”¼ì‚¬ì²´ê°€ ì•½ê°„ íë¦¿í•˜ê²Œ(Blurry) ë³´ìž„. | 0.3 |
| **CLAHE / Brightness** | ë¹„ë‹ í‘œë©´ì˜ ë‚œë°˜ì‚¬(Glare) ë° ì¡°ëª… ë³€í™”ì— ëŒ€ì‘í•˜ê¸° ìœ„í•¨. | 0.3 / 0.5 |

### ðŸ–¼ï¸ íŒŒì´í”„ë¼ì¸ ê²€ì¦ ê²°ê³¼
ì „ì²˜ë¦¬ê°€ ì ìš©ëœ í•™ìŠµ ë°ì´í„°(Train)ì™€ ì›ë³¸ ê²€ì¦ ë°ì´í„°(Valid)ê°€ ì˜¬ë°”ë¥´ê²Œ ë¡œë“œë˜ëŠ”ì§€ ì‹œê°í™” ê²€ì¦ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤.
*(ì—¬ê¸°ì— Streamlitì´ë‚˜ ë…¸íŠ¸ë¶ì—ì„œ ìº¡ì²˜í•œ ì‹œê°í™” ê²°ê³¼ ì´ë¯¸ì§€ë¥¼ ë„£ìœ¼ë©´ ì¢‹ìŠµë‹ˆë‹¤)*

---

## 4. í”„ë¡œì íŠ¸ êµ¬ì¡° (Directory Structure)

```bash
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ train_images/       # ì›ë³¸ í•™ìŠµ ì´ë¯¸ì§€
â”‚   â”œâ”€â”€ test_images/        # í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€
â”‚   â”œâ”€â”€ train.json          # 1ì°¨ ë³‘í•©ëœ JSON
â”‚   â””â”€â”€ train_final.json    # [Cleaned] ìœ ë ¹ ë°ì´í„°ê°€ ì œê±°ëœ ìµœì¢… í•™ìŠµìš© JSON
â”œâ”€â”€ notebooks/
â”‚   â””â”€â”€ preprocessing_pipeline.ipynb # ë°ì´í„° ë³‘í•©, EDA, ì „ì²˜ë¦¬ ê²€ì¦ ì½”ë“œ
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ config.py           # ê²½ë¡œ ë° í•˜ì´í¼íŒŒë¼ë¯¸í„° ì„¤ì •
â”‚   â”œâ”€â”€ dataset.py          # Albumentations ì ìš©ëœ Custom Dataset í´ëž˜ìŠ¤
â”‚   â””â”€â”€ utils.py            # ì‹œê°í™” ë° ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
â”œâ”€â”€ top30_pills_service.csv # [Service] ì„œë¹„ìŠ¤ ë§¤í•‘ìš© ì•Œì•½ ë¦¬ìŠ¤íŠ¸
â””â”€â”€ README.md
```

---

## 5. ì‹¤í–‰ ë°©ë²• (How to Run)

### 5.1 í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
```bash
pip install albumentations opencv-python matplotlib pandas tqdm
```

### 5.2 ë°ì´í„°ì…‹ ì¤€ë¹„ (Dataset Preparation)
* 1. data/ í´ë”ì— Kaggle ë°ì´í„°ë¥¼ ë‹¤ìš´ë¡œë“œ ë° ì••ì¶• í•´ì œí•©ë‹ˆë‹¤.
* 2. ì•„ëž˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ì—¬ ë¶„ì‚°ëœ JSONì„ ë³‘í•©í•˜ê³  í´ë¦¬ë‹í•©ë‹ˆë‹¤.

```bash
Python
# notebooks/preprocessing_pipeline.ipynb ì‹¤í–‰
# 1. JSON Merging
# 2. Data Cleaning (train_final.json ìƒì„±)
```

### 5.3 ë°ì´í„° ë¡œë” ê²€ì¦
```bash
Python

from src.dataset import PillDataset, train_transform
# ë°ì´í„°ì…‹ ë¡œë“œ ë° ì‹œê°í™” ìˆ˜í–‰
```

---

## 6. í–¥í›„ ê³„íš (Future Work)
* Model Training: êµ¬ì¶•ëœ íŒŒì´í”„ë¼ì¸ì„ ë°”íƒ•ìœ¼ë¡œ YOLOv8 ëª¨ë¸ í•™ìŠµ ì§„í–‰ (ì˜ˆì •).
* Performance Tuning: ë°ì´í„° ë¶ˆê· í˜• í•´ì†Œë¥¼ ìœ„í•œ Weighted Loss ì ìš© ê²€í† .
* Service Deployment: Streamlitì„ í™œìš©í•˜ì—¬ ì´¬ì˜ -> íƒì§€ -> ê¸ˆê¸° ì •ë³´ ì¶œë ¥ ì›¹ ì„œë¹„ìŠ¤ êµ¬í˜„.
